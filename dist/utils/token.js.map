{"version":3,"file":"token.js","sourceRoot":"/","sources":["utils/token.ts"],"names":[],"mappings":";;;;AAAA,wEAA+B;AAC/B,oDAAoB;AACpB,wDAAwB;AAExB,MAAM,cAAc,GAAG,cAAI,CAAC,OAAO,CAAC,SAAS,EAAE,sBAAsB,CAAC,CAAC;AACvE,MAAM,aAAa,GAAG,cAAI,CAAC,OAAO,CAAC,SAAS,EAAE,qBAAqB,CAAC,CAAC;AAErE,MAAM,UAAU,GAAG,YAAE,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC;AACnD,MAAM,SAAS,GAAG,YAAE,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;AAEjD,SAAgB,OAAO,CAAC,MAAc,EAAE,OAAyB;IAC/D,OAAO,sBAAG,CAAC,IAAI,CAAC,MAAM,EAAE,UAAU,kCAC7B,CAAC,OAAO,IAAI,OAAO,CAAC,KACvB,SAAS,EAAE,OAAO,IAClB,CAAC;AACL,CAAC;AALD,0BAKC;AAED,SAAgB,SAAS,CAAI,KAAa;IACxC,IAAI;QACF,MAAM,OAAO,GAAG,sBAAG,CAAC,MAAM,CAAC,KAAK,EAAE,SAAS,CAAM,CAAC;QAClD,OAAO,OAAO,CAAC;KAChB;IAAC,OAAO,CAAC,EAAE;QACV,qCAAqC;QACrC,MAAM,CAAC,CAAC;KACT;AACH,CAAC;AARD,8BAQC","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst privateKeyPath = path.resolve(__dirname, '../../privateKey.pem');\r\nconst publicKeyPath = path.resolve(__dirname, '../../publicKey.pem');\r\n\r\nconst privateKey = fs.readFileSync(privateKeyPath);\r\nconst publicKey = fs.readFileSync(publicKeyPath);\r\n\r\nexport function signJwt(object: object, options?: jwt.SignOptions): string {\r\n  return jwt.sign(object, privateKey, {\r\n    ...(options && options),\r\n    algorithm: 'RS256',\r\n  });\r\n}\r\n\r\nexport function verifyJwt<T>(token: string): T {\r\n  try {\r\n    const decoded = jwt.verify(token, publicKey) as T;\r\n    return decoded;\r\n  } catch (e) {\r\n    // Optionally handle or log the error\r\n    throw e;\r\n  }\r\n}\r\n"]}